<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>НаборДанных1</name>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ЛицевыеСчета.Период КАК Период,
    ЛицевыеСчета.Объект КАК Объект,
    ЛицевыеСчета.ЛицевойСчет КАК ЛицевойСчет
ПОМЕСТИТЬ ВТ_ЛицвыеСчета_НаНачалоПериода
ИЗ
    РегистрСведений.КВП_ЛицевыеСчета.СрезПоследних(&amp;НачалоПериода, ) КАК ЛицевыеСчета
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ЛицевыеСчета.Период КАК Период,
    ЛицевыеСчета.Объект КАК Объект,
    ЛицевыеСчета.ЛицевойСчет КАК ЛицевойСчет
ПОМЕСТИТЬ ВТ_ЛицвыеСчета_НаКонецПериода
ИЗ
    РегистрСведений.КВП_ЛицевыеСчета.СрезПоследних(&amp;КонецПериода, ) КАК ЛицевыеСчета
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ВТ_ЛицвыеСчета_НаНачалоПериода.Период КАК Период,
    ВТ_ЛицвыеСчета_НаНачалоПериода.Объект КАК Объект,
    ВТ_ЛицвыеСчета_НаНачалоПериода.ЛицевойСчет КАК ЛицевойСчет
ПОМЕСТИТЬ ВТ_ЛицвыеСчета_Объединение
ИЗ
    ВТ_ЛицвыеСчета_НаНачалоПериода КАК ВТ_ЛицвыеСчета_НаНачалоПериода

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
    ВТ_ЛицвыеСчета_НаКонецПериода.Период,
    ВТ_ЛицвыеСчета_НаКонецПериода.Объект,
    ВТ_ЛицвыеСчета_НаКонецПериода.ЛицевойСчет
ИЗ
    ВТ_ЛицвыеСчета_НаКонецПериода КАК ВТ_ЛицвыеСчета_НаКонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    МАКСИМУМ(ВТ_ЛицвыеСчета_Объединение.Период) КАК Период,
    ВТ_ЛицвыеСчета_Объединение.Объект КАК Объект,
    ВТ_ЛицвыеСчета_Объединение.ЛицевойСчет КАК ЛицевойСчет
ПОМЕСТИТЬ ВТ_ЛицвыеСчета_ПериодыОтбора
ИЗ
    ВТ_ЛицвыеСчета_Объединение КАК ВТ_ЛицвыеСчета_Объединение

СГРУППИРОВАТЬ ПО
    ВТ_ЛицвыеСчета_Объединение.Объект,
    ВТ_ЛицвыеСчета_Объединение.ЛицевойСчет
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ЛицевыеСчета.Период КАК Период,
    ЛицевыеСчета.Регистратор КАК Регистратор,
    ЛицевыеСчета.НомерСтроки КАК НомерСтроки,
    ЛицевыеСчета.Объект КАК Объект,
    ЛицевыеСчета.ЛицевойСчет КАК ЛицевойСчет,
    ЛицевыеСчета.Действует КАК Действует
ПОМЕСТИТЬ ВТ_ЛицвыеСчета
ИЗ
    РегистрСведений.КВП_ЛицевыеСчета КАК ЛицевыеСчета
ГДЕ
    ЛицевыеСчета.Активность = ИСТИНА
    И (ЛицевыеСчета.Период, ЛицевыеСчета.Объект, ЛицевыеСчета.ЛицевойСчет) В
            (ВЫБРАТЬ
                Т.Период,
                Т.Объект,
                Т.ЛицевойСчет
            ИЗ
                ВТ_ЛицвыеСчета_ПериодыОтбора КАК Т)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    МАКСИМУМ(РасчетПриборовУчета.Период) КАК Период,
    РасчетПриборовУчета.Объект КАК Объект,
    РасчетПриборовУчета.Счетчик КАК Счетчик,
    РасчетПриборовУчета.Услуга КАК Услуга,
    СУММА(РасчетПриборовУчета.Показание) КАК Расход
ПОМЕСТИТЬ ВТ_РасчетПриборовУчета
ИЗ
    РегистрНакопления.УПЖКХ_РасчетПриборовУчета КАК РасчетПриборовУчета
ГДЕ
    РасчетПриборовУчета.Активность = ИСТИНА
    И РасчетПриборовУчета.Период &gt;= &amp;НачалоПериода
    И РасчетПриборовУчета.Период &lt;= &amp;КонецПериода
    И РасчетПриборовУчета.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
    И РасчетПриборовУчета.ВидПоказания = ЗНАЧЕНИЕ(Перечисление.КВП_ВидыТарифов.Дневной)
    И РасчетПриборовУчета.Услуга В(&amp;Услуги)

СГРУППИРОВАТЬ ПО
    РасчетПриборовУчета.Объект,
    РасчетПриборовУчета.Счетчик,
    РасчетПриборовУчета.Услуга
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ИсторияСостоянийПриборовУчета.Период КАК Период,
    ИсторияСостоянийПриборовУчета.Объект КАК Объект,
    ИсторияСостоянийПриборовУчета.ПриборУчета КАК ПриборУчета
ПОМЕСТИТЬ ВТ_СостоянияПриборповУчета_НаНачалоПериода
ИЗ
    РегистрСведений.УПЖКХ_ИсторияСостоянийПриборовУчета.СрезПоследних(&amp;НачалоПериода, ) КАК ИсторияСостоянийПриборовУчета
ГДЕ
    ИСТИНА
    И ИсторияСостоянийПриборовУчета.ПриборУчета.ВидУслуги В(&amp;Услуги)
    И ИсторияСостоянийПриборовУчета.Объект В
            (ВЫБРАТЬ
                Т.ЛицевойСчет
            ИЗ
                ВТ_ЛицвыеСчета КАК Т)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ИсторияСостоянийПриборовУчета.Период КАК Период,
    ИсторияСостоянийПриборовУчета.Объект КАК Объект,
    ИсторияСостоянийПриборовУчета.ПриборУчета КАК ПриборУчета
ПОМЕСТИТЬ ВТ_СостоянияПриборповУчета_НаКонецПериода
ИЗ
    РегистрСведений.УПЖКХ_ИсторияСостоянийПриборовУчета.СрезПоследних(&amp;КонецПериода, ) КАК ИсторияСостоянийПриборовУчета
ГДЕ
    ИСТИНА
    И ИсторияСостоянийПриборовУчета.ПриборУчета.ВидУслуги В(&amp;Услуги)
    И ИсторияСостоянийПриборовУчета.Объект В
            (ВЫБРАТЬ
                Т.ЛицевойСчет
            ИЗ
                ВТ_ЛицвыеСчета КАК Т)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ВТ_СостоянияПриборповУчета_НаНачалоПериода.Период КАК Период,
    ВТ_СостоянияПриборповУчета_НаНачалоПериода.Объект КАК Объект,
    ВТ_СостоянияПриборповУчета_НаНачалоПериода.ПриборУчета КАК ПриборУчета
ПОМЕСТИТЬ ВТ_СостоянияПриборповУчета_Объединение
ИЗ
    ВТ_СостоянияПриборповУчета_НаНачалоПериода КАК ВТ_СостоянияПриборповУчета_НаНачалоПериода

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
    ВТ_СостоянияПриборповУчета_НаКонецПериода.Период,
    ВТ_СостоянияПриборповУчета_НаКонецПериода.Объект,
    ВТ_СостоянияПриборповУчета_НаКонецПериода.ПриборУчета
ИЗ
    ВТ_СостоянияПриборповУчета_НаКонецПериода КАК ВТ_СостоянияПриборповУчета_НаКонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    МАКСИМУМ(ВТ_СостоянияПриборповУчета_Объединение.Период) КАК Период,
    ВТ_СостоянияПриборповУчета_Объединение.Объект КАК Объект,
    ВТ_СостоянияПриборповУчета_Объединение.ПриборУчета КАК ПриборУчета
ПОМЕСТИТЬ ВТ_СостоянияПриборповУчета_ПериодыОтбора
ИЗ
    ВТ_СостоянияПриборповУчета_Объединение КАК ВТ_СостоянияПриборповУчета_Объединение

СГРУППИРОВАТЬ ПО
    ВТ_СостоянияПриборповУчета_Объединение.Объект,
    ВТ_СостоянияПриборповУчета_Объединение.ПриборУчета
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ИсторияСостоянийПриборовУчета.Период КАК Период,
    ИсторияСостоянийПриборовУчета.Объект КАК Объект,
    ИсторияСостоянийПриборовУчета.ПриборУчета КАК ПриборУчета,
    ИсторияСостоянийПриборовУчета.Действует КАК Действует,
    ИсторияСостоянийПриборовУчета.ДатаНачала КАК ДатаНачала,
    ИсторияСостоянийПриборовУчета.ДатаПоверки КАК ДатаПоверки,
    ИсторияСостоянийПриборовУчета.НомерПломбы КАК НомерПломбы,
    ИсторияСостоянийПриборовУчета.ПричинаОтключения КАК ПричинаОтключения
ПОМЕСТИТЬ ВТ_СостоянияПриборповУчета
ИЗ
    РегистрСведений.УПЖКХ_ИсторияСостоянийПриборовУчета КАК ИсторияСостоянийПриборовУчета
ГДЕ
    ИсторияСостоянийПриборовУчета.Активность = ИСТИНА
    И (ИсторияСостоянийПриборовУчета.Период, ИсторияСостоянийПриборовУчета.Объект, ИсторияСостоянийПриборовУчета.ПриборУчета) В
            (ВЫБРАТЬ
                Т.Период,
                Т.Объект,
                Т.ПриборУчета
            ИЗ
                ВТ_СостоянияПриборповУчета_ПериодыОтбора КАК Т)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ВТ_ЛицвыеСчета.Период КАК Период,
    ВТ_ЛицвыеСчета.Регистратор КАК Регистратор,
    ВТ_ЛицвыеСчета.НомерСтроки КАК НомерСтроки,
    ВТ_ЛицвыеСчета.Объект КАК Объект,
    ВТ_ЛицвыеСчета.ЛицевойСчет КАК ЛицевойСчет,
    ВТ_ЛицвыеСчета.Действует КАК ЛицевойСчетДействует,
    ВТ_СостоянияПриборповУчета.ПриборУчета КАК ПриборУчета,
    ВТ_СостоянияПриборповУчета.ПриборУчета.ВидУслуги КАК Услуга,
    ВТ_СостоянияПриборповУчета.Действует КАК СчетчикДействует,
    ВТ_СостоянияПриборповУчета.ДатаНачала КАК ДатаНачала,
    ВТ_СостоянияПриборповУчета.ДатаПоверки КАК ДатаПоверки,
    ВТ_СостоянияПриборповУчета.НомерПломбы КАК НомерПломбы,
    ВТ_СостоянияПриборповУчета.ПричинаОтключения КАК ПричинаОтключения
ПОМЕСТИТЬ ВТ_СчетчикиЛицевыхСчетов
ИЗ
    ВТ_ЛицвыеСчета КАК ВТ_ЛицвыеСчета
        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_СостоянияПриборповУчета КАК ВТ_СостоянияПриборповУчета
        ПО ВТ_ЛицвыеСчета.ЛицевойСчет = ВТ_СостоянияПриборповУчета.Объект
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ВЫРАЗИТЬ(ВТ_РасчетПриборовУчета.Объект КАК Справочник.КВП_ЛицевыеСчета) КАК ЛицевойСчет,
    ВТ_РасчетПриборовУчета.Счетчик КАК Счетчик,
    ВТ_РасчетПриборовУчета.Услуга КАК Услуга,
    ВТ_РасчетПриборовУчета.Расход КАК Расход
ПОМЕСТИТЬ ВТ_РасчетПриборовУчетаЛС
ИЗ
    ВТ_РасчетПриборовУчета КАК ВТ_РасчетПриборовУчета
ГДЕ
    ВТ_РасчетПриборовУчета.Объект ССЫЛКА Справочник.КВП_ЛицевыеСчета
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
    ВТ_СчетчикиЛицевыхСчетов.ЛицевойСчет КАК ЛицевойСчет,
    ВТ_СчетчикиЛицевыхСчетов.ЛицевойСчетДействует КАК ЛицевойСчетДействует,
    ВТ_СчетчикиЛицевыхСчетов.ПриборУчета КАК Счетчик,
    ВТ_СчетчикиЛицевыхСчетов.ПриборУчета.ЗаводскойНомер КАК ЗаводскойНомер,
    ВТ_СчетчикиЛицевыхСчетов.СчетчикДействует КАК СчетчикДействует,
    ВТ_СчетчикиЛицевыхСчетов.ДатаПоверки КАК ДатаПоверки,
    ВТ_СчетчикиЛицевыхСчетов.ПричинаОтключения КАК ПричинаОтключения,
    ЕСТЬNULL(ВТ_РасчетПриборовУчета.Услуга, ВТ_СчетчикиЛицевыхСчетов.Услуга) КАК Услуга,
    ЕСТЬNULL(ВТ_РасчетПриборовУчета.Расход, 0) КАК Расход
ИЗ
    ВТ_СчетчикиЛицевыхСчетов КАК ВТ_СчетчикиЛицевыхСчетов
        ЛЕВОЕ СОЕДИНЕНИЕ ВТ_РасчетПриборовУчетаЛС КАК ВТ_РасчетПриборовУчета
        ПО ВТ_СчетчикиЛицевыхСчетов.ЛицевойСчет = ВТ_РасчетПриборовУчета.ЛицевойСчет
            И ВТ_СчетчикиЛицевыхСчетов.Объект = ВТ_РасчетПриборовУчета.ЛицевойСчет.Адрес
            И ВТ_СчетчикиЛицевыхСчетов.ПриборУчета = ВТ_РасчетПриборовУчета.Счетчик
ГДЕ
    ВЫБОР
            КОГДА ВТ_РасчетПриборовУчета.ЛицевойСчет ЕСТЬ NULL
                ТОГДА ИСТИНА
            ИНАЧЕ ИСТИНА
        КОНЕЦ
		
		
		</query>
	</dataSet>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows"/>
	</settingsVariant>
</DataCompositionSchema>